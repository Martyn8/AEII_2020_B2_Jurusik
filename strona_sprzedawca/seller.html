<!doctype html>
<html lang="pl">

  <head>
    <meta charset="UTF-8">
    <title>Panel sprzedawcy</title>
    <link rel="stylesheet" href="seller_style.css" type="text/css" />
  </head>

  <script>
    function populate1(s1,s3)
    {
      var s1 = document.getElementById(s1);
      var s3 = document.getElementById(s3);
      s3.innerHTML = "";
      if(s1.value == "Wybierz rodzaj")
      {
        var optionArray = ["Wybierz czas|Wybierz czas"];
      } 
      else if(s1.value == "Karnet")
      {
        var optionArray = ["Wybierz czas|Wybierz czas","Tygodniowy|Tygodniowy","Miesięczny|Miesięczny"];
      } 
      else if(s1.value == "Bilet")
      {
        var optionArray = ["Wybierz czas|Wybierz czas","1h|1h","2h|2h","4h|4h"];
      }

      for(var option in optionArray)
      {
        var pair = optionArray[option].split("|");
        var newOption = document.createElement("option");
        newOption.value = pair[0];
        newOption.innerHTML = pair[1];
        s3.options.add(newOption);
      }
    }

    function populate2(s1,s2)
    {
      var s1 = document.getElementById(s1);
      var s2 = document.getElementById(s2);
      s2.innerHTML = "";
      if(s1.value == "Wybierz rodzaj")
      {
        var optionArray = ["Wybierz typ|Wybierz typ"];
      } 
      else if(s1.value == "Bilet" || s1.value == "Karnet")
      {
        var optionArray = ["Wybierz typ|Wybierz typ","Normalny|Normalny","Ulgowy|Ulgowy"];
      } 

      for(var option in optionArray)
      {
        var pair = optionArray[option].split("|");
        var newOption = document.createElement("option");
        newOption.value = pair[0];
        newOption.innerHTML = pair[1];
        s2.options.add(newOption);
      }
    }

    function displayPrice(s1,s2,s3)
    {
      var s1 = document.getElementById(s1);
      var s2 = document.getElementById(s2);
      var s3 = document.getElementById(s3);
      var price = "";
      if(s1.value == "Bilet")
      { 
        if(s2.value == "Ulgowy")
        {
          if(s3.value == "1h")
          {
            price = "8 zł";
          }
          else if(s3.value == "2h")
          {
            price = "12 zł";
          }
          else if(s3.value == "4h")
          {
            price = "15 zł";
          }
        }
        else if(s2.value == "Normalny")
        {
          if(s3.value == "1h")
          {
            price = "16 zł";
          }
          else if(s3.value == "2h")
          {
            price = "24 zł";
          }
          else if(s3.value == "4h")
          {
            price = "30 zł";
          }
        }
      }
      else if(s1.value == "Karnet")
      {
        if(s2.value == "Ulgowy")
        {
          if(s3.value == "Tygodniowy")
          {
            price = "80 zł";
          }
          else if(s3.value == "Miesięczny")
          {
            price = "300 zł";
          }
        }
        else if(s2.value == "Normalny")
        {
          if(s3.value == "Tygodniowy")
          {
            price = "160 zł";
          }
          else if(s3.value == "Miesięczny")
          {
            price = "600 zł";
          }
        }
      }
      document.getElementById("textValue").innerHTML = price;
    }

    function addToSummary(s1,s2,s3,chosenPrice)
    {
      var s1 = document.getElementById(s1);
      var s2 = document.getElementById(s2);
      var s3 = document.getElementById(s3);
      var p = document.getElementById("chosenPrice").rows[1].cells[0].innerHTML;
      if(p != 0)
      {
        var sum = parseInt(p, 10);
        document.getElementById("toPay").innerHTML += sum;
        var elem = "- " + s1.value + " " + s2.value + " " + s3.value;
        var table = document.getElementById("chosenElements");
        var row = table.insertRow(0);
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        cell1.innerHTML = elem;
        cell2.innerHTML = p;
        var btn = document.createElement("BUTTON");
        btn.innerHTML = "usuń";
        btn.onclick = function() {deleteButton(this); sumPrices()};
        btn.style.backgroundColor = 'orangered';
        btn.style.border = '2px solid black';
        btn.style.borderRadius = '4px';
        cell3.appendChild(btn);
      }
    }

    function deleteButton(r)
    {
      var i = r.parentNode.parentNode.rowIndex;
      document.getElementById("chosenElements").deleteRow(i);
    }

    function sumPrices()
    {
      var table = document.getElementById("chosenElements");
      var sum = 0;    
      for(var i = 0; i < chosenElements.rows.length; i++)
      {
        sum = sum + parseInt(chosenElements.rows[i].cells[1].innerHTML);
      }  
      if(sum == 0)
      {
        document.getElementById("toPay").innerHTML = "";
      }
      else
      {
        document.getElementById("toPay").innerHTML = sum + " zł";
      }
    }

    function makeTransaction(suma,paymentMethod)
    {
      var f = document.getElementById(paymentMethod);
      var s = document.getElementById("sum").rows[1].cells[0].innerHTML;
      if(f.value != "Wybierz formę płatności" && s != "")
      {
        alert("Przechodzenie do transakcji...");
      }
      else
      {
        alert("Brak wymaganych danych!");
      }
    }
  </script>
  
  <body>
    <div id=main> 
      <select id="s1" name="s1" onchange="populate1(this.id,'s3'); populate2(this.id,'s2'); displayPrice(this.id,'s2','s3')">
        <option value="Wybierz rodzaj">Wybierz rodzaj</option>
        <option value="Bilet">Bilet</option>
        <option value="Karnet">Karnet</option>
      </select>
      
      <select id="s2" name="s2" onchange="displayPrice('s1',this.id,'s3')">
        <option vaule="Wybierz typ">Wybierz typ</option>
      </select>

      <select id="s3" name="s3" onchange="displayPrice('s1','s2',this.id)">
        <option vaule="Wybierz czas">Wybierz czas</option>
      </select>
      
      <table id=chosenPrice>
        <tr>
          <th>Cena wybranego:</th>
        </tr>
        <tr>
          <th id="textValue"></th>
        </tr>
        <tr>
          <th colspan="2"><button id=add onclick="addToSummary('s1','s2','s3','textValue'); sumPrices()">Dodaj +</button></th>
        </tr>
      </table>

      <label id=summary>Podsumowanie</label>
      <table id=chosenElements>
      </table>
    </div>
      
    <select id=paymentMethod>
      <option>Wybierz formę płatności</option>
      <option>Gotówka</option>
      <option>Karta płatnicza</option>
      <option>Blik</option>
    </select>

    <table id=sum>
      <tr>
        <th>Suma do zapłaty:</th>
      </tr>
      <tr>
        <th id=toPay></th>
      </tr>
      <tr>
        <th><button id=transaction onclick="makeTransaction('sum','paymentMethod');">Przejdź do transakcji</button></th>
        <th><button onclick="window.location.reload()" id=clear>Wyczyść</button></th>
      </tr>
    </table>
    
  </body>
</html>